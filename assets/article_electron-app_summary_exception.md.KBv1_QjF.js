import{_ as e,c as n,o as l,j as i,ae as t,a as p,t as r}from"./chunks/framework.YyOF0cHw.js";const h="/docs/assets/img/2025-3/20250308210203.png",u=JSON.parse('{"title":"electron app异常摘要","description":"","frontmatter":{"title":"electron app异常摘要","date":"2025-3-5","outline":[2,3],"tags":"electron"},"headers":[],"relativePath":"article/electron-app_summary_exception.md","filePath":"article/electron-app_summary_exception.md"}'),k={name:"article/electron-app_summary_exception.md"},o={id:"frontmatter-title",tabindex:"-1"};function d(a,s,E,c,g,y){return l(),n("div",null,[i("h1",o,[p(r(a.$frontmatter.title)+" ",1),s[0]||(s[0]=i("a",{class:"header-anchor",href:"#frontmatter-title","aria-label":'Permalink to "{{ $frontmatter.title }}"'},"​",-1))]),s[1]||(s[1]=t(`<p>开发electron app过程中遇到的一些问题，找到解决方法后，在这里做一些整理，方便后续开发直接查阅。</p><h3 id="启动electron-app时会闪烁一下黑色区域" tabindex="-1">启动electron app时会闪烁一下黑色区域 <a class="header-anchor" href="#启动electron-app时会闪烁一下黑色区域" aria-label="Permalink to &quot;启动electron app时会闪烁一下黑色区域&quot;">​</a></h3><p>解决如下</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">BrowserWindow</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> require</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;electron&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> win</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> BrowserWindow</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ show: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">win.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">once</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;ready-to-show&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  win.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">show</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre></div><h3 id="鼠标拖拽窗口右边框扩大窗口时出现黑底" tabindex="-1">鼠标拖拽窗口右边框扩大窗口时出现黑底 <a class="header-anchor" href="#鼠标拖拽窗口右边框扩大窗口时出现黑底" aria-label="Permalink to &quot;鼠标拖拽窗口右边框扩大窗口时出现黑底&quot;">​</a></h3><p>解决如下：</p><ol><li>调用app.disableHardwareAcceleration关闭硬件加速效果会稍微好点</li></ol><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">app.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">disableHardwareAcceleration</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span></code></pre></div><ol start="2"><li>除非设置窗口resizable:false，不让扩大缩小</li></ol><h3 id="打包后不显示内容" tabindex="-1">打包后不显示内容 <a class="header-anchor" href="#打包后不显示内容" aria-label="Permalink to &quot;打包后不显示内容&quot;">​</a></h3><p>vite+vue3+vue-router electron 开发模式下调试好好的</p><p><a href="https://jesse121.github.io/blog/articles/2022/07/22.html" target="_blank" rel="noreferrer">参考网友详细分析文章</a>，简而言之就是</p><ol><li>当loadFil路径是字面量字符串时</li></ol><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (process.env.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">VITE_DEV_SERVER_URL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  win.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">loadURL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(process.env.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">VITE_DEV_SERVER_URL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Load your file</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  win.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">loadFile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;dist/index.html&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>开发模式下用加载用的是http协议，而loadFile(XXXX)使用的是本地文件协议</p><p><img src="`+h+`" alt=""></p><p>导致history模式下路由解析未按照预期进行，调整vue-router为hash模式即可解决问题。</p><ol start="2"><li>当loadFile路径需要拼接时，使用path.join()合成，而不是path.resolve，否则生成的路径也会导致加载不了index.html</li></ol><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (process.env.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">VITE_DEV_SERVER_URL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  win.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">loadURL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(process.env.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">VITE_DEV_SERVER_URL</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  //@ts-ignore  Load your file</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  win.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">loadFile</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(path.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">join</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">meta</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.env.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">VITE_WEB_BUILD_DIST</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;index.html&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">));</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="error-cannot-create-symbolic-link-�ܾ����ʡ�-c-users-admin-appdata-local-electron-builder-cache-wincodesign-583472143-darwin-10-12-lib-libcrypto-dylib" tabindex="-1">ERROR: Cannot create symbolic link : �ܾ����ʡ� : C:\\Users\\Admin\\AppData\\Local\\electron-builder\\Cache\\winCodeSign\\583472143\\darwin\\10.12\\lib\\libcrypto.dylib <a class="header-anchor" href="#error-cannot-create-symbolic-link-�ܾ����ʡ�-c-users-admin-appdata-local-electron-builder-cache-wincodesign-583472143-darwin-10-12-lib-libcrypto-dylib" aria-label="Permalink to &quot;ERROR: Cannot create symbolic link : �ܾ����ʡ� : C:\\Users\\Admin\\AppData\\Local\\electron-builder\\Cache\\winCodeSign\\583472143\\darwin\\10.12\\lib\\libcrypto.dylib&quot;">​</a></h3><p>win11 使用electron-builder打包报错</p><ol><li><p>手动下载winCodeSign <a href="https://github.com/electron-userland/electron-builder-binaries/releases/tag/winCodeSign-2.6.0" target="_blank" rel="noreferrer">链接</a></p></li><li><p>解压上面下载的文件，拷贝解压产生的文件夹<strong>winCodeSign-2.6.0</strong>至%LOCALAPPDATA%\\electron-builder\\Cache\\winCodeSign\\winCodeSign-2.6.0 我的win11是C:\\Users\\Admin\\AppData\\Local\\electron-builder\\Cache\\winCodeSign\\winCodeSign-2.6.0</p></li></ol><h3 id="errorout-fatal-error-unable-to-commit-changes" tabindex="-1">errorOut=Fatal error: Unable to commit changes <a class="header-anchor" href="#errorout-fatal-error-unable-to-commit-changes" aria-label="Permalink to &quot;errorOut=Fatal error: Unable to commit changes&quot;">​</a></h3><p>关闭电脑管家，杀毒软甲（如360等）</p><h3 id="app-builder-bin-win-x64-app-builder-exe-process-failed-err-electron-builder-cannot-execute" tabindex="-1">app-builder-bin\\win\\x64\\app-builder.exe process failed ERR_ELECTRON_BUILDER_CANNOT_EXECUTE <a class="header-anchor" href="#app-builder-bin-win-x64-app-builder-exe-process-failed-err-electron-builder-cannot-execute" aria-label="Permalink to &quot;app-builder-bin\\win\\x64\\app-builder.exe process failed ERR_ELECTRON_BUILDER_CANNOT_EXECUTE&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>• downloading     url=https://npmmirror.com/mirrors/electron-builder-binaries/nsis-3.0.4.1/nsis-3.0.4.1.7z size=1.3 MB parts=1</span></span>
<span class="line"><span>  • downloaded      url=https://npmmirror.com/mirrors/electron-builder-binaries/nsis-3.0.4.1/nsis-3.0.4.1.7z duration=998ms</span></span>
<span class="line"><span>  ⨯ exit status 2</span></span>
<span class="line"><span></span></span>
<span class="line"><span>1  failedTask=build stackTrace=Error: \\node_modules\\app-builder-bin\\win\\x64\\app-builder.exe process failed ERR_ELECTRON_BUILDER_CANNOT_EXECUTE</span></span>
<span class="line"><span>Exit code:</span></span></code></pre></div><p>解决如下：</p><ol><li><p>手动下载nsis <a href="https://npmmirror.com/mirrors/electron-builder-binaries/nsis-3.0.4.1/nsis-3.0.4.1.7z" target="_blank" rel="noreferrer">链接</a></p></li><li><p>解压上面下载的文件，拷贝解压产生的文件夹<strong>nsis-3.0.4.1</strong>至%LOCALAPPDATA%\\electron-builder\\Cache\\nsis\\nsis-3.0.4.1</p></li></ol>`,28))])}const m=e(k,[["render",d]]);export{u as __pageData,m as default};
